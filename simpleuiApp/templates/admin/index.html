<!DOCTYPE html>
{% load i18n static %}
{% load simpletags %}
{% get_current_language as LANGUAGE_CODE %}{% get_current_language_bidi as LANGUAGE_BIDI %}
<!--
   The project use: django-simpleui
   source code：
   https://github.com/newpanjing/simpleui
-->
<html lang="{{ LANGUAGE_CODE|default:"en-us" }}" {% if LANGUAGE_BIDI %}dir="rtl"{% endif %}>
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"/>
    {% block title %}
        <title>{{ site_title }}</title>
    {% endblock %}

    {% block icon %}
    {% endblock %}

    {% block css %}
        {% include 'admin/includes/css-part.html' %}
        <link rel="stylesheet" href="{% static 'admin/simpleui-x/css/index.css' %}?_=3.2">
        <link rel="stylesheet" href="{% static 'admin/simpleui-x/waves/waves.min.css' %}?_=2.1">
    {% endblock %}
    {% block head %}

    {% endblock %}
</head>
<body>
<style type="text/css">
    .el-tabs__nav .el-tabs__item:nth-child(1) .el-icon-close {
        display: none;
    }
    /* تصميم ديناميكي */
.responsive-dialog {
    max-width: 90vw;
    max-height: 80vh;
  }
  .breadcrumbs {
    margin-bottom: 16px;
  }
  /* تصميم الفوتر */
  .dialog-footer {
    display: flex;
    justify-content: flex-end;
  }

    * {
        -webkit-overflow-scrolling: touch;
    }

    [v-block] {
        display: none;
    }
</style>


{% verbatim dynamicCss %}
{% endverbatim dynamicCss %}

{% block menus %}
    {% autoescape off %}
        {% menus %}
    {% endautoescape %}
{% endblock %}
<div id="main" @click="mainClick($event)" v-block>
    <app-dialog :dialog-settings="dialogSettings"></app-dialog>

    <el-container :style="{height: height+'px'}">
  <transition name="el-zoom-in-center">
        <multiple-menu
                :menus="menus"
                :menu-active="menuActive"
                :fold="fold"
        ></multiple-menu>
        </transition>

        </el-aside>

        <el-container>
            <el-header class="navbar" style="font-size: 12px;padding: 10px;height: auto">
                <div class="float-wrap">
                    <div class="left">
                        <el-button v-waves circle icon="fas fa-bars"
                                   style="margin-right: 10px;border: none" @click="foldClick()"></el-button>

                        <el-breadcrumb v-if="!small" style="display: inline-block;" separator="/">
                            {% verbatim myclode %}
                                <el-breadcrumb-item><i :class="menus[0].icon"
                                                       :key="menus[0].name"></i>{{ menus[0].name }}
                                </el-breadcrumb-item>
                                <el-breadcrumb-item v-for="item in breadcrumbs"
                                                    :key="item">
                                <span :class="getIcon(item.name,item.icon)"></span>
                                <span v-text="item.name"></span>
                                </el-breadcrumb-item>
                            {% endverbatim myclode %}
                        </el-breadcrumb>
                    </div>

                    <div class="right">
                        <el-button icon="fas fa-font" circle v-waves @click="fontClick()"></el-button>

                        <el-button
                                :icon="this.zoom?'fas fa-compress-arrows-alt':'fas fa-expand-arrows-alt'"
                                @click="goZoom()" circle></el-button>
                        <el-button icon="fas fa-home" @click="goIndex('{{ 'SIMPLEUI_INDEX'|get_config }}')" circle
                                   v-waves></el-button>
                        {% verbatim mycode %}
                            <el-button @click="themeDialogVisible=true" v-waves>
                                <i class="fas fa-palette"></i>
                                <span v-text="getLanuage('Change theme')"></span><i
                                    class="el-icon-arrow-down el-icon--right"></i>
                            </el-button>

                        {% endverbatim mycode %}
                        <el-dropdown>
                            <el-button v-waves>
                                <i class="fas fa-user"></i>
                                {{ user }}<i class="el-icon-arrow-down el-icon--right"></i>
                            </el-button>
                            {% verbatim mycode %}

                                <el-dropdown-menu slot="dropdown">
                                    <el-dropdown-item v-waves icon="far fa-edit"
                                                      @click.native="changePassword()">{{ language.change_password }}
                                    </el-dropdown-item>
                                    </el-dropdown-item>
                                    <el-dropdown-item icon="el-icon-close"
                                                      @click.native="logout()"
                                                      divided>{{ language.logout }}</el-dropdown-item>
                                </el-dropdown-menu>
                            {% endverbatim mycode %}
                        </el-dropdown>
                    </div>
                </div>
            </el-header>
            <el-main>
               <!-- Main Tab View -->
    <el-tabs v-model="tabModel" type="border-card" editable :style="isResize ? 'height:100%' : 'height: calc(100% - 97px)'" @edit="handleTabsEdit" @tab-click="tabClick">
        <el-tab-pane v-for="(item, index) in tabs" :closable="index != 0"  :name="item.id" :key="item.id" lazy="true">
          <div class="iframe-wrap">
            <iframe :src="item.url" :id="item.id" @load="iframeLoad(item, $event)"></iframe>
            {% if "SIMPLEUI_LOADING"|get_config != False %}
              <div v-if="loading" class="loading" @dblclick="loading = false">
                <div class="center">
                  <span class="el-icon-loading"></span>
                  <span>loading...</span>
                </div>
              </div>
            {% endif %}

       
             



          </div>
     
        </el-tab-pane>
      </el-tabs>
  
      <!-- Dialog for selecting tabs -->
 
            </el-main>
        </el-container>
    </el-container>


    <ul v-if="popup.show" class="el-dropdown-menu el-popper" ref="popupmenu"
        :style="{position: 'absolute',top: popup.top+'px',left: popup.left+'px'}" x-placement="top-end">
        <li v-for="(item,index) in popup.menus" tabindex="-1" class="el-dropdown-menu__item"
            @click="item.handler(popup.tab,item)"><i :class="item.icon"></i><span
                v-text="item.text"></span>
        </li>
    </ul>
    <div v-if="dialogVisible" style="
    display: flex;          
      overflow-x: auto;       
      overflow-y: hidden;     
      padding: 10px;         
      gap: 10px;             
      box-sizing: border-box; 
      flex-wrap: nowrap;    ">
    <el-dialog
      v-for="dialog in dialogs"
      :key="dialog.id"
      :title="dialog.title"
      :visible.sync="dialog.visible"
      @close="closeDialog(dialog.id)"
      draggable
      @click="openDialog({ id: dialog.id, name: dialog.title, url: dialog.url })"

      :style="
      dialog.style
    "
    >
      <iframe :src="dialog.url" :id="dialog.id" style=" width: 350px;
      height: 350px" @load="iframeLoad(dialog, $event)"></iframe>
    </el-dialog>
  </div>
    <el-dialog
    :title="dialogConfig.title"
    :visible.sync="dialogConfig.show"
    :before-close="handleClose"
    :custom-class="dialogConfig.customClass"
    :width="dialogWidth"
    :height="dialogHeight"
  >
    <iframe
      ref="contentIframe"
      :src="dialogConfig.url"
      frameborder="0"
      @load="onIframeLoad"
    ></iframe>
  
  </el-dialog>
</div>


    {% block theme_dialog %}
        <el-dialog
                :title="getLanuage('Change theme')"
                :visible.sync="themeDialogVisible"
                :width="small?'90%':'50%'">
            {% block theme_body %}
                <div class="change-theme clearfix">
                    <div v-waves :class="{'theme-item':true,active:themeName==item.text}" v-for="(item,i) in themes"
                         :key="item.text"
                         :title="getLanuage(item.text)" @click="setTheme(item)">
                        <div class="theme-menu" :style="{background:item.menu}">
                            <div class="theme-logo" :style="{background: item.logo}"></div>
                        </div>
                        <div class="theme-top" :style="{background: item.top}"></div>
                    </div>
                </div>
            {% endblock %}
        </el-dialog>
    {% endblock %}

    {% block font_dialog %}
        <el-dialog
                :title="getLanuage('Set font size')"
                :visible.sync="fontDialogVisible"
                :width="small?'90%':'50%'">
            <el-slider v-model="fontSlider" :min="12" :max="100" show-input @change="fontSlideChange"></el-slider>
            <div style="text-align: right;padding-top: 20px">
                <el-button type="primary" @click="reset()" v-text="getLanuage('Reset')"></el-button>
            </div>
        </el-dialog>
    {% endblock %}
    <form style="display: none" id="logout_form" method="post" action="{% url 'admin:logout' %}">
        {% csrf_token %}
    </form>
</div>
{% block base_script %}
    <script type="text/javascript">
        {% if home %}
            var home = {
                id: '0',
                index: '1',
                name: '{{ title }}',
                icon: '{{ icon }}',
                active: true,
                eid: '1'
            }
        {% else %}
            var home = {
                id: '0',
                index: '1',
                eid: '1',
                name: "{% trans 'Home' %}",
                icon: 'fas fa-home'
            };
        {% endif %}
        menus.unshift(home);
        window.language = {
            change_password: '{% trans 'Change password' %}',
            logout: '{% trans 'Log out' %}',
            yes: '{% trans 'Yes' %}',
            no: '{% trans 'No' %}',
            confirm: '{% trans 'Are you sure?' %}'
        }
        window.themeUrl = '{% static 'admin/simpleui-x/theme/' %}';
        window.urls = {
            changePassword: "{% url 'admin:password_change' %}",
            logout: "{% url 'admin:logout' %}"
        }
        window.change=window.urls.changePassword
        var lanuageCode = '{% get_language %}';

        function localeError(e) {
            console.warn("Please add the {% get_language %}.js language file to the '/simpleui-x/theme' directory.")
            console.log("See simpleui i18n:https://github.com/newpanjing/simpleui/blob/master/i18n.md")
            console.log("或者加入QQ群:786576510 (Join QQ Group.)")

        }
    </script>

    {% include 'admin/includes/js-part.html' %}

    <script type="text/javascript">
        __simpleui_version = '{% simple_version %}';
    </script>
    <script type="text/javascript"
            src="{% static 'admin/simpleui-x/automatic/dicts.js' %}?_={% get_version %}"></script>
    <script type="text/javascript"
            src="{% static 'admin/simpleui-x/automatic/segment.js' %}?_={% get_version %}"></script>
    <script type="text/javascript" src="{% static 'admin/simpleui-x/locale/en-us.js' %}?_={% get_version %}"></script>
    <script type="text/javascript"
            src="{% static 'admin/simpleui-x/locale/' %}{% get_language %}.js?_={% get_version %}"
            onerror="localeError()"></script>
    <script type="text/javascript" src="{% static 'admin/simpleui-x/js/cookie.js' %}?_={% get_version %}"></script>
    <script type="text/javascript" src="{% static 'admin/simpleui-x/theme/theme.js' %}?_={% get_version %}"></script>
    <script type="text/javascript"
            src="{% static 'admin/simpleui-x/waves/waves.min.js' %}?_={% get_version %}"></script>
    {% block index_js %}
        <script type="text/javascript" src="{% static 'admin/simpleui-x/js/menu.js' %}?_={% get_version %}"></script>
        <script src="{% static 'admin/simpleui-x/js/components/dialog-header.js' %}"></script>
        <script src="{% static 'admin/simpleui-x/js/components/dialog-footer.js' %}"></script>
        <script src="{% static 'admin/simpleui-x/js/components/app-dialog.js' %}"></script>
        
        <script type="text/javascript" src="{% static 'admin/simpleui-x/js/index.js' %}?_={% get_version %}"></script>
        <script src="{% static 'admin/simpleui-x/js/helper/dialogHelper.js' %}"></script>
    {% endblock %}
    {% block autoupdate %}

    {% endblock %}
{% endblock %}
{% load_analysis %}
{% block script %}
{% endblock %}
</body>
</html>